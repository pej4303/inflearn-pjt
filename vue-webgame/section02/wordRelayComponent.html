<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>끝말잇기 - 컴포넌트</title>
  <!-- Vue 3 CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
  <div id="root">
    <word-relay init-word="판교"></word-relay>
    <word-relay init-word="휴가"></word-relay>
    <word-relay></word-relay>
  </div>
</body>
<script>
  const { ref, nextTick } = Vue;

  const app = Vue.createApp({});

  app.component('word-relay', {
    template: `
      <div>
        <div>{{ word }}</div>
        <form @submit.prevent="onSubmitForm">
          <input type="text" v-model.trim="inputValue" placeholder="단어를 입력하세요" ref="refInput" autocomplete="off" />
          <button type="submit">입력</button>
        </form>
        <div>{{ resultStr }}</div>
        <br />
      </div>
    `,
    props: {
      initWord: {
        type: String,
        default: '제로초',
      },
    },
    setup(props) {
      const word = ref(props.initWord);  // 제시어
      const inputValue = ref('');        // 입력 단어
      const resultStr = ref('');         // 결과
      const refInput = ref(null);        // input 참조

      const onSubmitForm = () => {
        if (!inputValue.value) {
          alert('단어를 입력해주세요.');
          refInput.value.focus();
          return;
        }

        if (inputValue.value.slice(0, 1) === word.value.slice(-1)) {
          word.value = inputValue.value;
          resultStr.value = '딩동댕';
        } else {
          resultStr.value = '땡~!';
        }

        inputValue.value = '';
        nextTick(() => refInput.value.focus());
      };

      return {
        word,
        inputValue,
        resultStr,
        refInput,
        onSubmitForm
      };
    },
  });

  app.mount('#root');
</script>
</html>
